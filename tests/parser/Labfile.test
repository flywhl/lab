PROVIDER core

EXPERIMENT SupervisedTraining AS train
    FOR network IN [spk-vih, relu-vi]
    REPEAT 10
    WITH
        Network FROM network
        AND Dataset Chewie
        AND Optimizer Adam
        AND Loss MeanSquaredError
        AND Hypers WITH
            epochs  100
            lr      0.0005
            batch   128
            dt      0.001


PLOT train

EXPERIMENT SimulateReach AS single_reach
    FOR network IN train
    REPEAT all
    WITH
        NETWORK FROM network.network
        AND DATASET FROM network.dataset
        AND HYPERS WITH
            DT FROM network.hypers.dt

EXPERIMENT ISIActivityCorrelation AS corr_isi_activity
    FOR network IN single_reach
    REPEAT all
    WITH
        SPIKES FROM network.state.z
        GO_CUE FROM network.dataset.idx_go_cue

EXPERIMENT DoSomething AS smth
    WITH
        NETWORK FROM train.network
        MYMODEL MyModelSubclass
        AND HYPERS WITH
            foo 1.5
